-- Created by Vertabelo (http://vertabelo.com)
-- Last modification date: 2015-06-14 06:42:07.219




-- tables
-- Table: CHI_TIET_HOA_DON
CREATE TABLE CHI_TIET_HOA_DON (
    MA_HD int  NOT NULL,
    MA_SACH int  NOT NULL,
    SO_LUONG int  NOT NULL,
    TONG_TIEN money  NOT NULL,
    NHAN_XET int  NOT NULL,
    HOA_DON_MA_HD int  NOT NULL,
    CONSTRAINT CHI_TIET_HOA_DON_pk PRIMARY KEY (MA_HD,MA_SACH)
)
;





-- Table: HOA_DON
CREATE TABLE HOA_DON (
    MA_HD int  NOT NULL,
    MA_KH int  NOT NULL,
    NGAY_MUA datetime  NOT NULL,
    GIA_TIEN money  NOT NULL,
    KHACH_HANG_MA_KH int  NOT NULL,
    CONSTRAINT HOA_DON_pk PRIMARY KEY (MA_HD)
)
;





-- Table: KHACH_HANG
CREATE TABLE KHACH_HANG (
    MA_KH int  NOT NULL,
    TEN_KH nvarchar(30)  NOT NULL,
    DIA_CHI nvarchar(50)  NOT NULL,
    SDT int  NOT NULL,
    EMAIL nvarchar(50)  NOT NULL,
    CONSTRAINT KHACH_HANG_pk PRIMARY KEY (MA_KH)
)
;





-- Table: SACH
CREATE TABLE SACH (
    MA_SACH int  NOT NULL,
    MA_TG int  NOT NULL,
    TEN_SACH nvarchar(30)  NOT NULL,
    GIA money  NOT NULL,
    NGAY_XB datetime  NOT NULL,
    THE_LOAI_MA_TL int  NOT NULL,
    CHI_TIET_HOA_DON_MA_HD int  NOT NULL,
    CHI_TIET_HOA_DON_MA_SACH int  NOT NULL,
    CONSTRAINT SACH_pk PRIMARY KEY (MA_SACH)
)
;





-- Table: SACH_TG
CREATE TABLE SACH_TG (
    MA_SACH int  NOT NULL,
    MA_TG int  NOT NULL,
    SACH_MA_SACH int  NOT NULL,
    CONSTRAINT SACH_TG_pk PRIMARY KEY (MA_SACH,MA_TG)
)
;





-- Table: TAC_GIA
CREATE TABLE TAC_GIA (
    MA_TG int  NOT NULL,
    TEN_TAC_GIA nvarchar(30)  NOT NULL,
    DIA_CHI nvarchar(50)  NOT NULL,
    SDT int  NOT NULL,
    NAM_SINH datetime  NOT NULL,
    SACH_TG_MA_SACH int  NOT NULL,
    SACH_TG_MA_TG int  NOT NULL,
    CONSTRAINT TAC_GIA_pk PRIMARY KEY (MA_TG)
)
;





-- Table: THE_LOAI
CREATE TABLE THE_LOAI (
    MA_SACH int  NOT NULL,
    MA_TL int  NOT NULL,
    TEN_TL nvarchar(50)  NOT NULL,
    CONSTRAINT THE_LOAI_pk PRIMARY KEY (MA_TL)
)
;









-- foreign keys
-- Reference:  CHI_TIET_HOA_DON_HOA_DON (table: CHI_TIET_HOA_DON)


ALTER TABLE CHI_TIET_HOA_DON ADD CONSTRAINT CHI_TIET_HOA_DON_HOA_DON 
    FOREIGN KEY (HOA_DON_MA_HD)
    REFERENCES HOA_DON (MA_HD)
;

-- Reference:  HOA_DON_KHACH_HANG (table: HOA_DON)


ALTER TABLE HOA_DON ADD CONSTRAINT HOA_DON_KHACH_HANG 
    FOREIGN KEY (KHACH_HANG_MA_KH)
    REFERENCES KHACH_HANG (MA_KH)
;

-- Reference:  SACH_CHI_TIET_HOA_DON (table: SACH)


ALTER TABLE SACH ADD CONSTRAINT SACH_CHI_TIET_HOA_DON 
    FOREIGN KEY (CHI_TIET_HOA_DON_MA_HD,CHI_TIET_HOA_DON_MA_SACH)
    REFERENCES CHI_TIET_HOA_DON (MA_HD,MA_SACH)
;

-- Reference:  SACH_TG_SACH (table: SACH_TG)


ALTER TABLE SACH_TG ADD CONSTRAINT SACH_TG_SACH 
    FOREIGN KEY (SACH_MA_SACH)
    REFERENCES SACH (MA_SACH)
;

-- Reference:  SACH_THE_LOAI (table: SACH)


ALTER TABLE SACH ADD CONSTRAINT SACH_THE_LOAI 
    FOREIGN KEY (THE_LOAI_MA_TL)
    REFERENCES THE_LOAI (MA_TL)
;

-- Reference:  TAC_GIA_SACH_TG (table: TAC_GIA)


ALTER TABLE TAC_GIA ADD CONSTRAINT TAC_GIA_SACH_TG 
    FOREIGN KEY (SACH_TG_MA_SACH,SACH_TG_MA_TG)
    REFERENCES SACH_TG (MA_SACH,MA_TG)
;





-- End of file.

